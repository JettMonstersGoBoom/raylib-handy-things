 
I switched this to not use a bunch of switch statements, making it more flexible. 

